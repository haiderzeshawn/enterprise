upstream {{ item.service_host_name }}_upstream {
    
    # Primary backend server
    server {{ primary_backend_server }}:{{ item.service_port }} weight=1 max_fails=3 fail_timeout=30s;
    
    # Secondary backend server (commented for future use)
    # server {{ secondary_backend_server }}:{{ item.service_port }} weight=1 max_fails=3 fail_timeout=30s;
    
    # Health check configuration
    keepalive 32;
    keepalive_requests 1000;
    keepalive_timeout 60s;
}
